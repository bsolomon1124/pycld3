version: 2.1

jobs:
  manylinux1_wheels:
    machine:
      image: ubuntu-1604:201903-01
    steps:
      - checkout
      - run:
          name: Build manylinux1 wheels
          command: |
            IMAGE_NAME=manylinux1_protobuf
            docker image build -f docker/Dockerfile.protobuf -t "$IMAGE_NAME" docker/
            docker container run --rm --volume "${PWD}":/io "$IMAGE_NAME" /io/build-wheels.sh
      - store_artifacts:
          path: wheelhouse/
  # macos_wheels:
  #   macos:
  #     xcode: "11.4.0"
  #   environment:
  #     HOMEBREW_NO_AUTO_UPDATE: 1
  #   steps:
  #     - checkout
  #     - run:
  #         name: Build MacOS wheels
  #         command: |
  #           brew install

